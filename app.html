<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Shift Planner</title>
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="192x192" href="favicon-192x192.png">
  <link rel="shortcut icon" href="favicon.ico">
  
  <style id="accent-color-overrides"></style>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link rel="stylesheet" href="app.css">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0d6efd">
</head>
<body>

  <aside id="sidebar" class="sp-sidebar">
    <div class="px-3 mb-3">
      <div class="d-flex align-items-center gap-2 ps-2">
        <span class="material-icons-outlined">event_note</span>
        <a class="label text-white text-decoration-none" data-bs-toggle="tab" href="#tab-home">
          Shift Planner
        </a>
      </div>
    </div>
    <nav class="nav flex-column" id="navTabs">
      <a class="nav-link active" data-bs-toggle="tab" href="#tab-home">
        <span class="material-icons-outlined">home</span> <span class="label">Home</span>
      </a>
      <a class="nav-link" data-bs-toggle="tab" href="#tab-visual">
        <span class="material-icons-outlined">calendar_month</span> <span class="label">Jaarplanner</span>
      </a>
      <a class="nav-link" data-bs-toggle="tab" href="#tab-shifts">
        <span class="material-icons-outlined">schedule</span> <span class="label">Shifts</span>
      </a>
      <a class="nav-link" data-bs-toggle="tab" href="#tab-invoer">
        <span class="material-icons-outlined">list_alt</span> <span class="label">Invoer</span>
      </a>
      <a class="nav-link" data-bs-toggle="tab" href="#tab-historiek">
        <span class="material-icons-outlined">query_stats</span> <span class="label">Historiek</span>
      </a>
      <a class="nav-link" data-bs-toggle="tab" href="#tab-converter">
        <span class="material-icons-outlined">calculate</span> <span class="label">Converter</span>
      </a>
      <a class="nav-link" data-bs-toggle="tab" href="#tab-nonbillable">
        <span class="material-icons-outlined">timer_off</span> <span class="label">Non-Billable</span>
      </a>
      <a class="nav-link" data-bs-toggle="tab" href="#tab-mail">
        <span class="material-icons-outlined">mail</span>
        <span class="label">Mailbox</span>
        <span id="mailSidebarBadge" class="badge bg-danger ms-1 d-none">0</span>
      </a>
      <a class="nav-link d-none" id="adminApprovalTabBtn" data-bs-toggle="tab" href="#tab-goedkeuring">
        <span class="material-icons-outlined">fact_check</span> <span class="label">Goedkeuring</span>
      </a>
      <a class="nav-link d-none" id="adminLeaveTabBtn" data-bs-toggle="tab" href="#tab-verlofbeheer">
        <span class="material-icons-outlined">event_available</span> <span class="label">Verlofbeheer</span>
      </a>
      <a class="nav-link d-none" id="adminHomeTabBtn" data-bs-toggle="tab" href="#tab-admin-home">
        <span class="material-icons-outlined">dashboard</span> <span class="label">Admin dashboard</span>
      </a>
      <a class="nav-link d-none" id="adminRoosterTabBtn" data-bs-toggle="tab" href="#tab-team-rooster">
        <span class="material-icons-outlined">calendar_view_month</span> <span class="label">Team rooster</span>
      </a>
      <a class="nav-link d-none" id="adminTabBtn" data-bs-toggle="tab" href="#tab-admin">
        <span class="material-icons-outlined">admin_panel_settings</span> <span class="label">Admin</span>
      </a>
    </nav>
  </aside>

  <nav class="sp-topbar">
    <div class="container-fluid h-100 d-flex align-items-center justify-content-between">
      <div class="d-flex align-items-center gap-2">
        <button id="sidebarToggle" class="btn btn-outline-primary btn-sm d-none d-md-inline-flex">
          <span class="material-icons-outlined">menu_open</span>
        </button>
        <button id="sidebarMobile" class="btn btn-outline-primary btn-sm d-inline-flex d-md-none">
          <span class="material-icons-outlined">menu</span>
        </button>
        <button id="quickTopBtn" class="btn btn-outline-warning btn-sm d-flex align-items-center gap-1" data-bs-toggle="modal" data-bs-target="#quickModal">
          <span class="material-icons-outlined">event</span> 
          <span class="d-none d-sm-inline">Snelle invoer</span>
        </button>
        <div class="chip d-none d-sm-inline-flex"><span class="dot"></span> <span id="envBadge">Online</span></div>
      </div>

      <div class="d-flex align-items-center gap-3 ms-auto">
        <span class="text-secondary small">Ingelogd als <strong id="currentUserName">-</strong></span>
        <div class="position-relative">
          <button id="notifBtn" class="btn btn-outline-secondary btn-sm position-relative">
            <span class="material-icons-outlined">notifications</span>
            <span id="notifBadge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger d-none">0</span>
          </button>
          <div id="notifDropdown" class="dropdown-menu dropdown-menu-end shadow p-2 d-none" style="min-width:300px;">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <strong>Meldingen</strong>
              <button id="markAllReadBtn" class="btn btn-link btn-sm text-decoration-none">Alles gelezen</button>
            </div>
            <ul id="notifList" class="list-unstyled mb-2" style="max-height: 300px; overflow-y: auto;"></ul>
            <div class="text-center mt-2">
              <button id="loadMoreNotifBtn" class="btn btn-outline-secondary btn-sm d-none">Toon meer</button>
            </div>
          </div>
        </div>
        <a id="topbarProfileBtn" data-bs-toggle="modal" data-bs-target="#profileModal" href="#" title="Mijn Profiel">
          <img id="topbarProfilePhoto" src="" alt="Profiel" class="rounded-circle" style="width: 32px; height: 32px; object-fit: cover; cursor: pointer; border: 1px solid #dee2e6;">
        </a>
      </div>
    </div>
  </nav>

  <main id="main" class="sp-main">
    <div class="tab-content">
      
      <section id="tab-home" class="tab-pane fade show active">
        <div class="d-flex flex-wrap justify-content-between align-items-center mb-3">
          <h5 class="mb-0">Welkom, <span id="homeUserName">-</span></h5>
          <div class="d-flex flex-wrap gap-2">
            <button id="homeBtnQuickInput" class="btn btn-outline-warning btn-sm">
              <span class="material-icons-outlined">event</span> Snelle invoer
            </button>
            <button id="homeBtnGoInvoer" class="btn btn-outline-primary btn-sm">
              <span class="material-icons-outlined">table_view</span> Naar Invoer
            </button>
            <button id="homeBtnNewShift" class="btn btn-primary btn-sm">
              <span class="material-icons-outlined">add</span> Nieuwe shift
            </button>
          </div>
        </div>
        <div class="card shadow-sm border-0 mb-3 bg-primary-subtle">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <h6 class="mb-0 text-primary-emphasis">
                <span class="material-icons-outlined align-middle me-1">campaign</span>
                Team Mededelingen
              </h6>
              <button id="addAnnouncementBtn" class="btn btn-sm btn-primary d-none">
                <span class="material-icons-outlined" style="font-size:16px">add</span>
              </button>
            </div>
            <div id="announcementList">
              <small class="text-muted">Geen mededelingen.</small>
            </div>
          </div>
        </div>
        <div class="card shadow-sm border-0 mb-3">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <div>
                <div class="small text-muted">Voortgang â€” <span id="homeMonthName">-</span></div>
                <div class="fw-semibold">
                  Gepland: <span id="homeMonthPlanned">0u 0min</span>
                  &nbsp;|&nbsp; Doel: <span id="homeMonthTarget">0u 0min</span>
                  &nbsp;|&nbsp; Verschil: <span id="homeMonthDiff">0u 0min</span>
                </div>
              </div>
              <span class="badge bg-secondary-subtle text-dark" id="homeMonthStatus">Concept</span>
            </div>
            <div class="progress" style="height: 10px;">
              <div id="homeMonthProgress" class="progress-bar" role="progressbar" style="width:0%;"></div>
            </div>
          </div>
        </div>
        <div class="mb-3">
          <span class="badge bg-secondary-subtle text-dark me-2" id="homeLeave">Verlof: â€”</span>
          <span class="badge bg-secondary-subtle text-dark" id="homeSchoolLeave">Schoolverlof: â€”</span>
        </div>
        <div class="row g-3">
          <div class="col-12 col-lg-6">
            <div class="card shadow-sm border-0 h-100">
              <div class="card-body">
                <h6 class="mb-2">Actieve projecten (vandaag)</h6>
                <div class="row g-2" id="homeProjects"></div>
              </div>
            </div>
          </div>
          <div class="col-12 col-lg-6">
            <div class="card shadow-sm border-0 h-100">
              <div class="card-body">
                <h6 class="mb-2">Laatste meldingen</h6>
                <ul class="mb-0" id="homeNotifList"></ul>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="tab-visual" class="tab-pane fade">
        <div class="d-flex flex-wrap justify-content-between align-items-center mb-3 gap-2">
          <div>
            <h5 class="mb-0">Jaarplanner (Kladblok)</h5>
            <small class="text-muted">Visuele planning. BeÃ¯nvloedt de uren-telling niet.</small>
          </div>
          <div class="d-flex gap-2">
            <select id="visYear" class="form-select form-select-sm" style="width:90px;"></select>
            <button id="btnExportPlanPdf" class="btn btn-outline-danger btn-sm" title="Download PDF">
              <span class="material-icons-outlined" style="font-size:18px; vertical-align:middle;">picture_as_pdf</span>
            </button>
            <button id="btnSharePlan" class="btn btn-primary btn-sm d-flex align-items-center gap-1" title="Kopieer naar gebruiker">
              <span class="material-icons-outlined" style="font-size:18px;">ios_share</span>
              <span class="d-none d-sm-inline">KopiÃ«ren naar...</span>
            </button>
          </div>
        </div>

        <div class="row g-0">
          <div class="col-md-10">
            <div class="card shadow-sm border-0" style="overflow-x: auto;">
              <div class="card-body p-2">
                <div id="yearGrid" class="year-grid"></div>
              </div>
            </div>
          </div>
          <div class="col-md-2 ps-2">
            <div class="card shadow-sm border-0 h-100">
              <div class="card-header bg-white fw-bold small py-1">Legende</div>
              <div class="card-body p-2">
                <button id="visEraser" class="btn btn-outline-secondary btn-sm w-100 mb-2 d-flex align-items-center justify-content-center gap-2">
                  <span class="material-icons-outlined" style="font-size:16px">backspace</span> Wissen
                </button>
                <div id="visLegend" class="d-flex flex-column gap-1 overflow-auto" style="max-height: 80vh;">
                  </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section id="tab-shifts" class="tab-pane fade">
        <div class="d-flex flex-wrap gap-2 justify-content-between align-items-center mb-3">
          <h5 class="mb-0">Shifts</h5>
          <div class="d-flex flex-wrap gap-2">
            <select id="filterShiftYear" class="form-select form-select-sm"></select>
            <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#shiftModal">
              <span class="material-icons-outlined">add</span> Nieuwe shift
            </button>
          </div>
        </div>
        <div class="table-responsive">
          <table class="table table-striped table-hover align-middle table-nowrap">
            <thead class="table-light">
              <tr><th>Naam</th><th>Start</th><th>Einde</th><th>Pauze (min)</th><th>Project</th><th>Periode</th><th class="text-end">Acties</th></tr>
            </thead>
            <tbody id="shiftTableBody"></tbody>
          </table>
        </div>
      </section>

      <section id="tab-invoer" class="tab-pane fade">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div class="row g-2 align-items-center mb-3 w-100">
            <div class="col-12 col-md-auto d-flex flex-wrap gap-2">
              <select id="monthSelectMain" class="form-select form-select-sm w-auto">
                <option value="0">Januari</option><option value="1">Februari</option><option value="2">Maart</option>
                <option value="3">April</option><option value="4">Mei</option><option value="5">Juni</option>
                <option value="6">Juli</option><option value="7">Augustus</option><option value="8">September</option>
                <option value="9">Oktober</option><option value="10">November</option><option value="11">December</option>
              </select>
              <select id="yearSelectMain" class="form-select form-select-sm w-auto"></select>
              <select id="projectFilterSelect" class="form-select form-select-sm w-auto">
                <option value="">Alle projecten</option>
              </select>
            </div>
            <div class="col-12 col-md-auto mt-2 mt-md-0">
              <span id="monthStatusBadge" class="badge badge-status badge-draft">Concept</span>
              <span id="leaveBalanceBadge" class="badge bg-secondary-subtle text-dark ms-2">Verlof: -</span>
              <span id="schoolLeaveBalanceBadge" class="badge bg-secondary-subtle text-dark ms-2">Schoolverlof: -</span>
            </div>
            <div class="col-12 col-md-auto d-flex gap-2">
              <button id="exportPdfBtn" class="btn btn-outline-danger btn-sm">Export PDF</button>
              <button id="multiDayShiftBtn" class="btn btn-outline-primary btn-sm">Meerdere dagen</button>
              <button id="submitMonthBtn" class="btn btn-outline-success btn-sm">Indienen</button>
            </div>
          </div>
          <div id="remainingHoursAlert" class="alert small d-none mb-3"></div>
        </div>
        <div class="row g-3 mb-3">
          <div class="col-6 col-md-2">
            <label class="form-label">Doel uren</label>
            <input id="monthTargetHours" type="number" min="0" value="0" class="form-control form-control-sm" />
          </div>
          <div class="col-6 col-md-2">
            <label class="form-label">Doel min</label>
            <input id="monthTargetMinutes" type="number" min="0" value="0" class="form-control form-control-sm" />
          </div>
        </div>
        <div class="table-responsive">
          <table class="table table-striped table-hover align-middle table-nowrap">
            <thead class="table-light">
              <tr>
                <th id="thActions">Acties</th>
                <th>Dag</th><th>Datum</th><th>Project</th><th>Shift</th><th>Start</th><th>Einde</th><th>Pauze</th><th>Omschrijving</th><th>Duur</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
        <div id="projectSummary" class="mt-3"></div>
      </section>

      <section id="tab-historiek" class="tab-pane fade">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h5 class="mb-0">Historiek â€” <span id="currentUserHistoriek">-</span> â€” Jaar: <span id="historiekJaar"></span></h5>
        </div>
        <div class="table-responsive">
          <table id="historyTable" class="table table-striped table-hover align-middle table-nowrap">
            <thead class="table-light">
              <tr><th>Maand</th><th>Doel uren</th><th>Gepland</th><th>Verschil</th><th>Verlof</th><th>Ziekte</th><th>Schoolverlof</th><th>Feestdag</th><th>Bench</th></tr>
            </thead>
            <tbody id="historyBody"></tbody>
            <tfoot class="table-light">
              <tr>
                <th>Totaal</th>
                <th id="totDoel">0u 0m</th><th id="totGepland">0u 0m</th><th id="totVerschil">0u 0m</th>
                <th id="totVerlof">0u 0m</th><th id="totZiekte">0u 0m</th><th id="totSchool">0u 0m</th>
                <th id="totFeest">0u 0m</th><th id="totBench">0u 0m</th>
              </tr>
            </tfoot>
          </table>
        </div>
      </section>

      <section id="tab-converter" class="tab-pane fade">
        <h5>Uren/minuten â†” decimale uren</h5>
        <div class="row g-3">
          <div class="col-6 col-md-2">
            <label>Uren</label><input id="convHours" type="number" class="form-control" />
          </div>
          <div class="col-6 col-md-2">
            <label>Minuten</label><input id="convMinutes" type="number" class="form-control" />
          </div>
          <div class="col-12 col-md-3">
            <label>Decimale uren</label><input id="decimalInput" type="number" step="0.01" class="form-control" />
          </div>
        </div>
      </section>

      <section id="tab-mail" class="tab-pane fade">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h5 class="mb-0">Mailbox</h5>
          <div class="d-flex gap-2">
            <div id="mailFolderNav" class="btn-group btn-group-sm">
              <button id="mailTabInbox" class="btn btn-outline-primary active" data-folder="inbox">Inbox</button>
              <button id="mailTabSent" class="btn btn-outline-secondary" data-folder="sent">Verzonden</button>
            </div>
            <button id="mailRefreshBtn" class="btn btn-outline-secondary btn-sm"><span class="material-icons-outlined">refresh</span></button>
            <button id="mailComposeBtn" class="btn btn-primary btn-sm">Nieuw bericht</button>
          </div>
        </div>
        <div id="mailComposeCard" class="card p-3 mb-3 d-none">
          <div class="row g-2">
            <div class="col-md-3"><label>Aan</label><select id="mailToSelect" class="form-select"></select></div>
            <div class="col-md-9"><label>Onderwerp</label><input id="mailSubjectInput" class="form-control"></div>
            <div class="col-12"><label>Bericht</label><textarea id="mailBodyInput" rows="5" class="form-control"></textarea></div>
            <div class="col-12"><button id="mailSendBtn" class="btn btn-success">Versturen</button><button id="mailCancelBtn" class="btn btn-outline-secondary ms-2">Annuleren</button></div>
          </div>
        </div>
        <div class="row g-3">
          <div class="col-12 col-lg-5">
            <div class="card border-0 shadow-sm">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-2">
                  <h6 class="mb-0" id="mailListTitle">Inbox</h6>
                  <div class="d-flex gap-2">
                     <button id="mailMarkAllReadBtn" class="btn btn-outline-secondary btn-sm">Alles gelezen</button>
                     <button id="mailDeleteAllBtn" class="btn btn-outline-danger btn-sm">Alles verwijderen</button>
                  </div>
                </div>
                <div class="table-responsive" style="max-height:400px; overflow:auto;">
                  <table class="table table-hover align-middle mb-0"><tbody id="mailListBody"></tbody></table>
                </div>
              </div>
            </div>
          </div>
          <div class="col-12 col-lg-7">
            <div class="card border-0 shadow-sm"><div class="card-body" id="mailDetail"><div class="text-muted small">Selecteer een berichtâ€¦</div></div></div>
          </div>
        </div>
      </section>

      <section id="tab-nonbillable" class="tab-pane fade">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h5 class="mb-0">Non-Billable</h5>
          <div class="d-flex gap-2">
            <select id="nbMonthSelect" class="form-select form-select-sm" style="width:120px;"></select>
            <select id="nbYearSelect" class="form-select form-select-sm" style="width:100px;"></select>
          </div>
        </div>
        <div class="row g-3 mb-3">
          <div class="col-md-6">
            <div class="card shadow-sm border-0 h-100 p-3">
              <h6 class="text-secondary">Totaal deze maand</h6>
              <span class="fs-4 fw-bold" id="nbTotalDisplay">0u 0m</span>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card shadow-sm border-0 h-100 p-3">
              <h6 class="text-secondary">Totaal in <span id="nbYearTotalLabel">-</span></h6>
              <span class="fs-4 fw-bold text-primary" id="nbYearTotalDisplay">0u 0m</span>
            </div>
          </div>
        </div>
        <div class="card p-3 mb-3 border-0 shadow-sm">
          <h6 class="mb-3">Nieuwe invoer</h6>
          <div class="row g-2 align-items-end">
            <div class="col-md-3">
              <label class="small">Categorie</label>
              <div class="input-group input-group-sm">
                <select id="nbCategorySelect" class="form-select"></select>
                <button class="btn btn-outline-secondary" id="nbAddCategoryBtn">+</button>
              </div>
            </div>
            <div class="col-md-2"><label class="small">Datum</label><input type="date" id="nbDateInput" class="form-control form-control-sm"></div>
            <div class="col-md-2">
              <label class="small">Duur (u:m)</label>
              <div class="input-group input-group-sm">
                <input type="number" id="nbHoursInput" class="form-control" placeholder="U">
                <span class="input-group-text">:</span>
                <input type="number" id="nbMinutesInput" class="form-control" placeholder="M">
              </div>
            </div>
            <div class="col-md-3"><label class="small">Omschrijving</label><input type="text" id="nbNoteInput" class="form-control form-control-sm"></div>
            <div class="col-md-2"><button id="nbAddBtn" class="btn btn-primary btn-sm w-100">Toevoegen</button></div>
          </div>
        </div>
        <div class="table-responsive">
          <table class="table table-striped table-hover align-middle">
            <thead class="table-light"><tr><th>Datum</th><th>Categorie</th><th>Omschrijving</th><th>Duur</th><th class="text-end">Actie</th></tr></thead>
            <tbody id="nbTableBody"></tbody>
          </table>
        </div>
      </section>

      <section id="tab-admin-home" class="tab-pane fade">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h5 class="mb-0">Admin Dashboard</h5>
          <button id="adminDashboardRefreshBtn" class="btn btn-sm btn-outline-primary"><span class="material-icons-outlined">refresh</span> Vernieuwen</button>
        </div>
        <div class="row g-3 mb-3">
          <div class="col-md-4"><div class="stat-card bg-warning text-dark p-3 rounded"><div id="statPendingMonths" class="fs-2 fw-bold">0</div><div>Maanden ter goedkeuring</div></div></div>
          <div class="col-md-4"><div class="stat-card bg-danger text-white p-3 rounded"><div id="statSickHours" class="fs-2 fw-bold">0u</div><div>Uren Ziek (huidige maand)</div></div></div>
          <div class="col-md-4"><div class="stat-card bg-info text-white p-3 rounded"><div id="statLeaveHours" class="fs-2 fw-bold">0u</div><div>Uren Verlof (huidige maand)</div></div></div>
        </div>
        <div class="row g-3">
          <div class="col-lg-6">
            <h6>Maanden ter Goedkeuring</h6>
            <table class="table table-striped"><tbody id="adminPendingList"></tbody></table>
          </div>
          <div class="col-lg-6">
            <h6>Gebruikers achter op planning</h6>
            <table class="table table-striped"><tbody id="adminBehindList"></tbody></table>
          </div>
        </div>
      </section>

      <section id="tab-team-rooster" class="tab-pane fade">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h5 class="mb-0">Team Planning</h5>
          <div class="d-flex gap-2">
            <select id="roosterMonth" class="form-select form-select-sm"></select>
            <select id="roosterYear" class="form-select form-select-sm"></select>
            <button id="refreshRoosterBtn" class="btn btn-outline-primary btn-sm"><span class="material-icons-outlined">refresh</span></button>
          </div>
        </div>
        <div class="card border-0 shadow-sm">
          <div class="card-body p-0">
            <div class="table-responsive rooster-wrapper" style="max-height: 80vh;">
              <table class="table table-bordered table-sm mb-0 text-center align-middle rooster-table">
                <thead class="table-light"><tr id="roosterHeaderRow"></tr></thead>
                <tbody id="roosterBody"></tbody>
              </table>
            </div>
          </div>
        </div>
        <div id="roosterLegendContainer" class="mt-3 pt-2 border-top"></div>
      </section>

      <section id="tab-goedkeuring" class="tab-pane fade">
        <h5 class="mb-3">Jaaroverzicht Goedkeuringen</h5>
        <div class="card p-3 mb-3">
          <div class="row g-2 align-items-end">
            <div class="col-md-6"><label>Gebruiker</label><select id="approvalUserSelect" class="form-select"></select></div>
            <div class="col-md-3"><label>Jaar</label><input id="approvalYearSelect" type="number" class="form-control" readonly disabled></div>
          </div>
        </div>
        <div id="approvalYearlyOverview" class="row g-3"></div>
      </section>

      <section id="tab-verlofbeheer" class="tab-pane fade">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h5 class="mb-0">Verlofbeheer</h5>
          <button id="refreshLeaveRequestsBtn" class="btn btn-sm btn-outline-primary"><span class="material-icons-outlined">refresh</span> Vernieuwen</button>
        </div>
        <div class="table-responsive">
          <table class="table table-striped align-middle"><tbody id="leaveRequestTableBody"></tbody></table>
        </div>
      </section>

      <section id="tab-admin" class="tab-pane fade">
        <h5 class="mb-3">Admin Beheer</h5>
        <div class="card p-3 mb-3">
          <h6>Gebruikersbeheer</h6>
          <div class="row g-2 align-items-end">
            <div class="col-md-6"><label>Gebruiker</label><select id="adminUserSelect" class="form-select"></select></div>
            <div class="col-md-3"><label>Rol</label><select id="roleSelect" class="form-select"><option value="user">User</option><option value="admin">Admin</option></select></div>
            <div class="col-md-3 d-flex gap-2"><button id="updateRoleBtn" class="btn btn-warning w-100">Opslaan</button><button id="removeUserBtn" class="btn btn-danger w-100">Verwijder</button></div>
          </div>
          <div class="mt-2"><button id="saveSettingsBtn" class="btn btn-outline-secondary w-100">Schoolverlof instelling wisselen</button></div>
        </div>

        <div class="card p-3 mb-3">
          <h6>Projectbeheer</h6>
          <div class="row g-2 align-items-end">
            <div class="col-md-4"><label>Naam</label><input id="newProjectName" class="form-control"></div>
            <div class="col-md-3"><label>Start</label><input id="newProjectStart" type="date" class="form-control"></div>
            <div class="col-md-3"><label>Eind</label><input id="newProjectEnd" type="date" class="form-control"></div>
            <div class="col-md-2"><button id="addProjectBtn" class="btn btn-success w-100">Toevoegen</button></div>
          </div>
          <table class="table mt-3"><tbody id="projectTableBody"></tbody></table>
        </div>

        <div class="card p-3 mb-3">
          <h6>Verlof & Schoolverlof uren</h6>
          <div class="row g-2 align-items-end">
             <div class="col-md-4"><label>Kalenderjaar (uren)</label><input id="adminLeaveHours" type="number" class="form-control"></div>
             <div class="col-md-4"><label>Schooljaar</label><select id="adminSchoolYearSelect" class="form-select"></select></div>
             <div class="col-md-4"><label>Schoolverlof (uren)</label><input id="adminSchoolLeaveHours" type="number" class="form-control"></div>
          </div>
          <div class="row g-2 mt-2">
             <div class="col-6"><button id="adminSaveLeaveBtn" class="btn btn-primary w-100">Opslaan Kalenderjaar</button></div>
             <div class="col-6"><button id="adminSaveSchoolLeaveBtn" class="btn btn-success w-100">Opslaan Schooljaar</button></div>
          </div>
        </div>

        <div class="card p-3 mb-3">
           <h6>Goedkeuring Maand</h6>
           <div class="row g-2 align-items-end">
             <div class="col-md-3"><select id="adminApproveMonth" class="form-select"><option value="0">Jan</option><option value="1">Feb</option><option value="2">Mrt</option>...</select></div>
             <div class="col-md-3"><input id="adminApproveYear" type="number" class="form-control"></div>
             <div class="col-md-6 d-flex gap-2">
               <button id="adminApproveBtn" class="btn btn-success w-100">Goedkeuren</button>
               <button id="adminRejectBtn" class="btn btn-danger w-100">Afkeuren</button>
               <button id="adminReopenBtn" class="btn btn-secondary w-100">Heropenen</button>
             </div>
           </div>
        </div>
        
        <div class="card p-3 mb-3">
           <h6>Extra lijnen per maand</h6>
           <div class="row g-2 align-items-end">
             <div class="col-md-3"><select id="adminMultiMonth" class="form-select"><option value="0">Jan</option>...</select></div>
             <div class="col-md-3"><input id="adminMultiYear" type="number" class="form-control"></div>
             <div class="col-md-6"><div class="form-check form-switch"><input id="adminMultiAllow" class="form-check-input" type="checkbox"><label class="form-check-label">Toestaan</label></div></div>
           </div>
        </div>
      </section>

    </div>
  </main>

  <div class="modal fade" id="shiftModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">Shift</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <div class="row g-2">
            <div class="col-md-6"><label>Naam</label><input id="newShiftName" class="form-control" /></div>
            <div class="col-md-2" id="divShiftShort"><label>Afk.</label><input id="newShiftShort" class="form-control" maxlength="4" /></div>
            <div class="col-md-2" id="divShiftColor"><label>Kleur</label><input type="color" id="newShiftColor" class="form-control form-control-color w-100" value="#e9ecef"></div>
            <div class="col-6 col-md-3"><label>Start</label><input id="newShiftStart" type="time" class="form-control" /></div>
            <div class="col-6 col-md-3"><label>Einde</label><input id="newShiftEnd" type="time" class="form-control" /></div>
            <div class="col-6 col-md-3"><label>Pauze</label><input id="newShiftBreak" type="number" class="form-control" /></div>
            <div class="col-6 col-md-5"><label>Project</label><select id="newShiftProjectSelect" class="form-select"></select></div>
            <div class="col-6 col-md-4"><label>Vanaf</label><input id="newShiftStartDate" type="date" class="form-control" /></div>
            <div class="col-6 col-md-4"><label>Tot</label><input id="newShiftEndDate" type="date" class="form-control" /></div>
          </div>
        </div>
        <div class="modal-footer"><button id="addShiftBtn" class="btn btn-primary">Opslaan</button></div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="quickModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">Snelle invoer</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <div class="row g-2">
            <div class="col-md-6"><label>Datum</label><input type="date" id="quickDate" class="form-control" /></div>
            <div class="col-md-6"><label>Shift</label><select id="quickShift" class="form-select"></select></div>
            <div class="col-12"><label>Omschrijving</label><input type="text" id="quickNote" class="form-control" /></div>
          </div>
        </div>
        <div class="modal-footer"><button id="saveQuickBtn" class="btn btn-success">Opslaan</button></div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="multiDayModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">Meerdere dagen</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <div class="mb-3"><label>Dagen</label><input id="multiShiftDays" type="text" class="form-control" placeholder="Kies dagen..."></div>
          <div class="mb-3"><label>Shift</label><select id="multiShiftName" class="form-select"></select></div>
        </div>
        <div class="modal-footer"><button id="saveMultiShift" class="btn btn-primary">Opslaan</button></div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="attachmentModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">Bijlage</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <div id="currentAttachmentBox" class="d-none alert alert-info d-flex justify-content-between">
             <span id="currentAttachmentName">-</span>
             <div><a id="downloadAttachmentBtn" href="#" target="_blank" class="btn btn-sm btn-success">Download</a><button id="deleteAttachmentBtn" class="btn btn-sm btn-danger ms-1">Verwijder</button></div>
          </div>
          <div id="uploadAttachmentBox">
             <p id="uploadBoxLabel">Kies bestand (max 5MB):</p>
             <input type="file" id="attachmentUploadInput" class="form-control">
             <div class="progress mt-2 d-none" id="attachmentUploadProgressContainer"><div id="attachmentUploadProgress" class="progress-bar" style="width:0%"></div></div>
          </div>
        </div>
        <div class="modal-footer"><button id="uploadAttachmentBtn" class="btn btn-primary d-none">Upload</button></div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="announcementModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">Nieuwe Mededeling</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
          <textarea id="announcementInputText" class="form-control mb-3" rows="3" placeholder="Bericht..."></textarea>
          <div class="mb-3">
             <label>Kleur</label><br>
             <input type="radio" class="btn-check" name="annColor" id="cLight" value="light" checked><label class="btn btn-outline-secondary btn-sm" for="cLight">âšª</label>
             <input type="radio" class="btn-check" name="annColor" id="cInfo" value="info"><label class="btn btn-outline-info btn-sm" for="cInfo">ðŸ”µ</label>
             <input type="radio" class="btn-check" name="annColor" id="cSuccess" value="success"><label class="btn btn-outline-success btn-sm" for="cSuccess">ðŸŸ¢</label>
             <input type="radio" class="btn-check" name="annColor" id="cWarning" value="warning"><label class="btn btn-outline-warning btn-sm" for="cWarning">ðŸŸ </label>
             <input type="radio" class="btn-check" name="annColor" id="cDanger" value="danger"><label class="btn btn-outline-danger btn-sm" for="cDanger">ðŸ”´</label>
          </div>
          <div class="mb-3">
            <label>Afzender</label>
            <select id="announcementAuthorSelect" class="form-select">
              <option value="me">Mijn naam</option>
              <option value="Shift Planner">Shift Planner</option>
              <option value="Admin Team">Admin Team</option>
              <option value="custom">-- Anders --</option>
            </select>
            <input type="text" id="announcementCustomAuthor" class="form-control mt-2 d-none" placeholder="Typ naam...">
          </div>
        </div>
        <div class="modal-footer"><button id="saveAnnouncementBtn" class="btn btn-primary">Plaatsen</button></div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="profileModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header"><h5 class="modal-title">Profiel</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
        <div class="modal-body">
           <div class="row g-3">
             <div class="col-md-6">
               <div class="d-flex align-items-center mb-3">
                 <img id="profilePhoto" src="" class="rounded-circle me-3" style="width:64px;height:64px;object-fit:cover;background:#eee;">
                 <div><h6 class="mb-0">Gegevens</h6><p class="small text-muted mb-0">Pas je naam aan.</p></div>
               </div>
               <input type="text" id="profileName" class="form-control mb-2" placeholder="Naam">
               <input type="email" id="profileEmail" class="form-control mb-2" disabled>
               <button id="profileSaveBtn" class="btn btn-primary w-100">Opslaan</button>
               <hr>
               <div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="profileDarkModeToggle"><label class="form-check-label">Donkere modus</label></div>
               <div class="form-check form-switch mt-2"><input class="form-check-input" type="checkbox" id="profileSidebarToggle"><label class="form-check-label">Sidebar ingeklapt</label></div>
               <hr>
               <label class="small fw-bold">Opstart-tab</label>
               <select id="profileDefaultTab" class="form-select form-select-sm mb-3">
                 <option value="#tab-home">Home</option><option value="#tab-shifts">Shifts</option><option value="#tab-invoer">Invoer</option>
               </select>
               <button id="enableNotifBtn" class="btn btn-outline-primary btn-sm w-100 mb-2">Activeer Meldingen</button>
               <div id="notifStatusText" class="text-muted small fst-italic"></div>
               <fieldset id="profileNotifPrefs" class="mt-2">
                 <label class="small fw-bold">Auto herinneringen:</label>
                 <div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="prefNotifyDailyEmpty"><label class="form-check-label small">Lege dag</label></div>
                 <div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="prefNotifyWeeklyEmpty"><label class="form-check-label small">Lege week</label></div>
                 <div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="prefNotifyMonthlyGoal"><label class="form-check-label small">Maanddoel</label></div>
                 <div class="form-check form-switch"><input class="form-check-input" type="checkbox" id="prefNotifyProjectEnd"><label class="form-check-label small">Project einde</label></div>
               </fieldset>
             </div>
             <div class="col-md-6">
                <div class="card p-3 mb-3 border-0 shadow-sm">
                   <h6>Accentkleur</h6>
                   <div id="profileColorPicker" class="color-picker-wrap">
                      <span class="color-dot" data-color="#0d6efd" style="background:#0d6efd"></span>
                      <span class="color-dot" data-color="#198754" style="background:#198754"></span>
                      <span class="color-dot" data-color="#fd7e14" style="background:#fd7e14"></span>
                      <span class="color-dot" data-color="#6f42c1" style="background:#6f42c1"></span>
                      <span class="color-dot" data-color="#dc3545" style="background:#dc3545"></span>
                      <span class="color-dot" data-color="#d63384" style="background:#d63384"></span>
                   </div>
                </div>
                <div class="card p-3 mb-3 border-0 shadow-sm">
                   <h6>Exporteer Data</h6>
                   <button id="profileExportBtn" class="btn btn-outline-info w-100">Download .json</button>
                </div>
                <button id="logoutBtn" class="btn btn-outline-danger w-100">Uitloggen</button>
             </div>
           </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="sharePlanModal" tabindex="-1">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Planning KopiÃ«ren</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <p>
            Kies een gebruiker. De jaarplanning van <strong id="sharePlanYearDisplay"></strong> 
            wordt naar deze gebruiker gekopieerd (en overschrijft hun huidige kladblok-planning voor dat jaar).
          </p>
          <div class="mb-3">
            <label class="form-label">Naar gebruiker:</label>
            <select id="sharePlanUserSelect" class="form-select">
              <option value="">-- Kies gebruiker --</option>
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuleren</button>
          <button type="button" id="confirmSharePlanBtn" class="btn btn-primary">KopiÃ«ren & Opslaan</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/nl.js"></script>
  <script type="module" src="app.js"></script>

  <div id="loadingOverlay" class="loading-overlay d-none">
    <div class="spinner-border text-light" role="status"><span class="visually-hidden">Laden...</span></div>
  </div>  
</body>
</html>
